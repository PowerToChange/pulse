<%= javascript_include_tag "stats.js" %>


<h1 id="statsTitle">Measurements</h1>

<div id="statsLinkBox" class="statsFormBox">
  <ul class="statsLinkList">
    <% if authorized?("new", "weekly_reports") %>
      <li class="statsListLink"><%= link_to "Submit your weekly stats", url_for(:controller => :weekly_reports, :action => :new) %></li>
    <% end %>
    <% if authorized?("new", "monthly_reports") %>
      <li class="statsListLink"><%= link_to "Submit your monthly stats", url_for(:controller => :monthly_reports, :action => :new) %></li>
    <% end %>
    <% if authorized?("new", "semester_reports") %>
      <li class="statsListLink"><%= link_to "Submit your semester highlights", url_for(:controller => :semester_reports, :action => :new) %></li>
    <% end %>
    <% if authorized?("semester_at_a_glance", "stats") %>
      <li class="statsListLink"><%= link_to "Semester at a glance", url_for(:controller => :stats, :action => :semester_at_a_glance) %></li>
    <% end %>
    <% if authorized?("how_people_came_to_christ", "stats") %>
      <li class="statsListLink"><%= link_to "How people came to Christ", url_for(:controller => :stats, :action => :how_people_came_to_christ) %></li>
    <% end %>
  </ul>
</div>

<div class="statsFormContainer">
  <div class="statsFormBox">
    <br/>

    <% form_for :report, :html => { :name => 'reportForm' } do |form| %>
      
      <%= render :partial => "choose_ministry" %>

      <div id="statsRadioButtonContainer" <%= "class='notDisplayed'" if @hide_radios %>>
        <br/>
        <div id="summaryRadioButton" class="statsRadioButton">
          <%= form.radio_button :summary, "summary", :checked => @stats_summary %>
          <%= form.label :summary_summary, "Summary" %>
          <%= observe_field 'report_summary_summary', :url => {:action => "select_report"},
                                                      :with => "getWithStringForReportForm()",
                                                      :before => "beginLoadingStatsTab()",
                                                      :complete => "completeLoadingStatsTab()" %>
        </div>

        <div class="statsRadioButton">
          <%= form.radio_button :summary, "campus", :checked => !@stats_summary %>
          <%= form.label :summary_campus, "Campus drill-down" %>
          <%= observe_field 'report_summary_campus', :url => {:action => "select_report"},
                                                     :with => "getWithStringForReportForm()",
                                                     :before => "beginLoadingStatsTab()",
                                                     :complete => "completeLoadingStatsTab()" %>
        </div>
        <br/>
      </div>
      
    <% end %>

    <br/>

    <div id="statsReportTimeTabs">
      <div id="year" class="statsReportTab statsFormField <%= "statsTabActive" if @selected_time_tab_id == "year" %>" >
        <%= time_tab_link_to_remote("year") %>
      </div>


      <div id="semester" class="statsReportTab statsFormField <%= "statsTabActive" if @selected_time_tab_id == "semester" %>" >
        <%= time_tab_link_to_remote("semester") %>
      </div>


      <div id="month" class="statsReportTab statsFormField <%= "statsTabActive" if @selected_time_tab_id == "month" %>" >
        <%= time_tab_link_to_remote("month") %>
      </div>


      <div id="week" class="statsReportTab statsFormField <%= "statsTabActive" if @selected_time_tab_id == "week" %> <%= "notDisplayed" if @stats_summary %>" >
        <%= time_tab_link_to_remote("week") %>
      </div>
    </div>

  </div>
</div>


<br/>


<div id="results" class="statsContainer">
  <div id="statsSpinnerContainer"><%= image_tag("/images/default/shared/blue-loading.gif", :id => "spinnerStatsResults", :alt => "Spinner") %></div>
  <div id="statsYearResults" class="statsReportTabContainer" style="display: none;"></div>
  <div id="statsSemesterResults" class="statsReportTabContainer" style="display: none;"></div>
  <div id="statsMonthResults" class="statsReportTabContainer" style="display: none;"></div>
  <div id="statsWeekResults" class="statsReportTabContainer" style="display: none;"></div>
  <br/>
</div>

