
<p class="statsTitle"><%= @report_description %></p>
<table class="statsTable">
    <tr>
        <td>
        </td>
        <% semesters = Semester.find_semesters_by_year(@year_id) %>

        <% semesters.each do |semester| %>
          <td class="statsTableTitle">
            <%=  semester.description %>
            <%#=link_to "#{semester.description}", :action => "semester_at_a_glance", :report => { 'ministry' => @ministry_id, 'campus_id' => @campus_id, 'semester' => "#{semester.description}"} %>
          </td>
        <% end %>

        <td class="statsTableTitle">
            Total
        </td>

    </tr>
    <tr class="<%= cycle('highlight', 'nohighlight') %>">
        <td class="statsTableTitle">
            Spiritual Conversations by Staff
        </td>
        <% total = 0 
           totalSection = Hash.new
        %>

        <% semesters.each do |semester| %>
          <td>
              <%= stat = Week.find_stats_semester_campuses(semester.id, @campuses_selected, sp_conv) %>
              <% total += stat %>
              <% totalSection[semester.id] = stat %>
          </td>
        <% end %>

        <td>
            <%= total %>
            <% totalSection[:total] = total %>
        </td>
    </tr>
    <tr class="<%= cycle('highlight', 'nohighlight') %>">
        <td class="statsTableTitle">
            Spiritual Conversations by Students
        </td>
        <% total = 0 %>

        <% semesters.each do |semester| %>
          <td>
              <%= stat = Week.find_stats_semester_campuses(semester.id, @campuses_selected, sp_conv_std) %>
              <% total += stat %>
              <% totalSection[semester.id] += stat %>
          </td>
        <% end %>

        <td>
            <%= total %>
            <% totalSection[:total] += total %>
        </td>
    </tr>
    <tr class="<%= cycle('highlight', 'nohighlight') %> statsTableTotal">
        <td class="statsTableTitle">
            Spiritual Conversations Total
        </td>

        <% semesters.each do |semester| %>
          <td>
              <%= totalSection[semester.id] %>
          </td>
        <% end %>

        <td>
            <%= totalSection[:total] %>
        </td>
    </tr>
    <tr class="<%= cycle('highlight', 'nohighlight') %>">
        <td class="statsTableTitle">
            Gospel Presentations by Staff
        </td>
        <% total = 0 %>

        <% semesters.each do |semester| %>
          <td>
              <%= stat = Week.find_stats_semester_campuses(semester.id, @campuses_selected, gos_pres) %>
              <% total += stat %>
              <% totalSection[semester.id] = stat %>
          </td>
        <% end %>

        <td>
            <%= total %>
            <% totalSection[:total] = total %>
        </td>
    </tr>
    <tr class="<%= cycle('highlight', 'nohighlight') %>">
        <td class="statsTableTitle">
            Gospel Presentations by Students
        </td>
        <% total = 0 %>

        <% semesters.each do |semester| %>
          <td>
              <%= stat = Week.find_stats_semester_campuses(semester.id, @campuses_selected, gos_pres_std) %>
              <% total += stat %>
              <% totalSection[semester.id] += stat %>
          </td>
        <% end %>

        <td>
            <%= total %>
            <% totalSection[:total] += total %>
        </td>
    </tr>
    <tr class="<%= cycle('highlight', 'nohighlight') %> statsTableTotal">
        <td class="statsTableTitle">
            Gospel Presentations Total
        </td>

        <% semesters.each do |semester| %>
          <td>
              <%= totalSection[semester.id] %>
          </td>
        <% end %>

        <td>
            <%= totalSection[:total] %>
        </td>
    </tr>
    <tr class="<%= cycle('highlight', 'nohighlight') %>">
        <td class="statsTableTitle">
            Holy Spirit Presentations
        </td>
        <% total = 0 %>

        <% semesters.each do |semester| %>
          <td>
              <%= stat = Week.find_stats_semester_campuses(semester.id, @campuses_selected, hs_pres) %>
              <% total += stat %>
          </td>
        <% end %>
        
        <td>
            <%= total %>
        </td>
    </tr>
    <% if @semester_highlights_permission %>
    <tr class="<%= cycle('highlight', 'nohighlight') %>">
        <td class="statsTableTitle">
            Average - hours of prayer:
        </td>
        <% total = 0 %>

        <% semesters.each do |semester| %>
          <td>
              <%= stat = semester.find_stats_semester_campuses(@campuses_selected, :semesterreport_avgPrayer ) %>
              <% total += stat %>
          </td>
        <% end %>
        
        <td>
            <%= total %>
        </td>
    </tr>
    <tr class="<%= cycle('highlight', 'nohighlight') %>">
        <td class="statsTableTitle">
            Average weekly meetings attendance:
        </td>
        <% total = 0 %>

        <% semesters.each do |semester| %>
          <td>
              <%= stat = semester.find_stats_semester_campuses(@campuses_selected, :average_attendance_weekly_meetings) %>
              <% total += stat %>
          </td>
        <% end %>
        
        <td>
            <%= total %>
        </td>
    </tr>
    <tr class="<%= cycle('highlight', 'nohighlight') %>">
        <td class="statsTableTitle">
            Number challenged to staff:
        </td>
        <% total = 0 %>

        <% semesters.each do |semester| %>
          <td>
              <%= stat = semester.find_stats_semester_campuses(@campuses_selected, :number_challenged_staff ) %>
              <% total += stat %>
          </td>
        <% end %>
        
        <td>
            <%= total %>
        </td>
    </tr>
    <tr class="<%= cycle('highlight', 'nohighlight') %>">
        <td class="statsTableTitle">
            Number challenged to internships:
        </td>
        <% total = 0 %>

        <% semesters.each do |semester| %>
          <td>
              <%= stat = semester.find_stats_semester_campuses(@campuses_selected, :number_challenged_internships) %>
              <% total += stat %>
          </td>
        <% end %>
        
        <td>
            <%= total %>
        </td>
    </tr>
    <tr class="<%= cycle('highlight', 'nohighlight') %>">
        <td class="statsTableTitle">
            Number of frosh involved:
        </td>
        <% total = 0 %>

        <% semesters.each do |semester| %>
          <td>
              <%= stat = semester.find_stats_semester_campuses(@campuses_selected, :number_frosh_involved) %>
              <% total += stat %>
          </td>
        <% end %>
        
        <td>
            <%= total %>
        </td>
    </tr>
    <tr class="<%= cycle('highlight', 'nohighlight') %>">
        <td class="statsTableTitle">
            Number of staff-led DGs:
        </td>
        <% total = 0 %>

        <% semesters.each do |semester| %>
          <td>
              <%= stat = semester.find_stats_semester_campuses(@campuses_selected, :number_staff_led_dg) %>
              <% total += stat %>
          </td>
        <% end %>
        
        <td>
            <%= total %>
        </td>
    </tr>
    <tr class="<%= cycle('highlight', 'nohighlight') %>">
        <td class="statsTableTitle">
            Number in staff-led DGs:
        </td>
        <% total = 0 %>

        <% semesters.each do |semester| %>
          <td>
              <%= stat = semester.find_stats_semester_campuses(@campuses_selected, :number_in_staff_led_dg) %>
              <% total += stat %>
          </td>
        <% end %>
        
        <td>
            <%= total %>
        </td>
    </tr>
    <tr class="<%= cycle('highlight', 'nohighlight') %>">
        <td class="statsTableTitle">
            Number of student-led DGs:
        </td>
        <% total = 0 %>

        <% semesters.each do |semester| %>
          <td>
              <%= stat = semester.find_stats_semester_campuses(@campuses_selected, :number_student_led_dg) %>
              <% total += stat %>
          </td>
        <% end %>
        
        <td>
            <%= total %>
        </td>
    </tr>
    <tr class="<%= cycle('highlight', 'nohighlight') %>">
        <td class="statsTableTitle">
            Number in student-led DGs:
        </td>
        <% total = 0 %>

        <% semesters.each do |semester| %>
          <td>
              <%= stat = semester.find_stats_semester_campuses(@campuses_selected, :number_in_student_led_dg) %>
              <% total += stat %>
          </td>
        <% end %>
        
        <td>
            <%= total %>
        </td>
    </tr>
    <tr class="<%= cycle('highlight', 'nohighlight') %>">
        <td class="statsTableTitle">
            Number of spiritual multipliers in staff DGs:
        </td>
        <% total = 0 %>

        <% semesters.each do |semester| %>
          <td>
              <%= stat = semester.find_stats_semester_campuses(@campuses_selected, :number_sp_mult_in_staff_led_dg) %>
              <% total += stat %>
          </td>
        <% end %>
        
        <td>
            <%= total %>
        </td>
    </tr>
    <tr class="<%= cycle('highlight', 'nohighlight') %>">
        <td class="statsTableTitle">
            Number of spiritual multipliers in student-led DGs:
        </td>
        <% total = 0 %>

        <% semesters.each do |semester| %>
          <td>
              <%= stat = semester.find_stats_semester_campuses(@campuses_selected, :number_sp_mult_in_student_led_dg) %>
              <% total += stat %>
          </td>
        <% end %>
        
        <td>
            <%= total %>
        </td>
    </tr>
    <% end %>
    <tr>
        <td>
            <br/>
        </td>
    </tr>
    <tr class="highlight">
        <td class="statsTableTitle">
            Indicated Decisions
        </td>
        <% total = 0 %>

        <% semesters.each do |semester| %>
          <td>
              <%= stat = Prc.count_by_semester_and_campuses(semester.id, @campuses_selected) %>
          </td>
          <% total += stat %>
        <% end %>

        <td>
            <%= total %>
        </td>
    </tr>
</table>
