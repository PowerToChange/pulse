
<p><span class="statsTitle"><%= @report_description %></span></p>
<table class="statsTable">
    <tr>
        <td>
        </td>
        <% @months.each do |month| -%>
            <td>
                <span class="statsTableTitle"><%= sprintf "%s", month.description %></span>
            </td>
        <% end %>
        <td>
            <span class="statsTableTitle">Total</span>
        </td>
    </tr>
    <tr class="<%= cycle('highlight', 'nohighlight') %>">
        <td class="statsTableTitle">
            Spiritual Conversations by Staff
        </td>
        <% total = 0 
           totalSection = Hash.new
        %>
        <% @months.each do |month| -%>
        <% result = Week.find_ministry_stats_month(month.id,@stats_ministry_id,sp_conv) %>
        <% total += result %>
        <% totalSection[month.id] = result %>
        <td>
            <%= sprintf "%s", result %>
        </td>
        <% end %>
        <td>
            <%= sprintf "%s", total %>
            <% totalSection[:total] = total %>
        </td>
    </tr>
    <tr class="<%= cycle('highlight', 'nohighlight') %>">
        <td class="statsTableTitle">
            Spiritual Conversations by Students
        </td>
        <% total = 0 %>
        <% @months.each do |month| -%>
        <% result = Week.find_ministry_stats_month(month.id,@stats_ministry_id,sp_conv_std) %>
        <% total += result %>
        <% totalSection[month.id] += result %>
        <td>
            <%= sprintf "%s", result %>
        </td>
        <% end %>
        <td>
            <%= sprintf "%s", total %>
            <% totalSection[:total] += total %>
        </td>
    </tr>
    <tr class="<%= cycle('highlight', 'nohighlight') %> statsTableTotal">
        <td class="statsTableTitle">
            Spiritual Conversations Total
        </td>
        <% total = 0 %>
        <% @months.each do |month| -%>
        <td>
        <%= totalSection[month.id] %>
        </td>
        <% end %>
        <td>
            <%= totalSection[:total] %>
        </td>
    </tr>
    <tr class="<%= cycle('highlight', 'nohighlight') %>">
        <td class="statsTableTitle">
            Gospel Presentations by Staff
        </td>
        <% total = 0 %>
        <% @months.each do |month| -%>
        <% result = Week.find_ministry_stats_month(month.id,@stats_ministry_id,gos_pres) %>
        <% total += result %>
        <% totalSection[month.id] = result %>
        <td>
            <%= sprintf "%s", result %>
        </td>
        <% end %>
        <td>
            <%= sprintf "%s", total %>
            <% totalSection[:total] = total %>
        </td>
    </tr>
    <tr class="<%= cycle('highlight', 'nohighlight') %>">
        <td class="statsTableTitle">
            Gospel Presentations by Students
        </td>
        <% total = 0 %>
        <% @months.each do |month| -%>
        <% result = Week.find_ministry_stats_month(month.id,@stats_ministry_id,gos_pres_std) %>
        <% total += result %>
        <% totalSection[month.id] += result %>
        <td>
            <%= sprintf "%s", result %>
        </td>
        <% end %>
        <td>
            <%= sprintf "%s", total %>
            <% totalSection[:total] += total %>
        </td>
    </tr>
    <tr class="<%= cycle('highlight', 'nohighlight') %> statsTableTotal">
        <td class="statsTableTitle">
            Gospel Presentations Total
        </td>
        <% total = 0 %>
        <% @months.each do |month| -%>
        <td>
        <%= totalSection[month.id] %>
        </td>
        <% end %>
        <td>
            <%= totalSection[:total] %>
        </td>
    </tr>
    <tr class="<%= cycle('highlight', 'nohighlight') %>">
        <td class="statsTableTitle">
            Holy Spirit Presentations by Staff
        </td>
        <% total = 0 %>
        <% @months.each do |month| -%>
        <% result = Week.find_ministry_stats_month(month.id,@stats_ministry_id,hs_pres) %>
        <% total += result %>
        <td>
            <%= sprintf "%s", result %>
        </td>
        <% end %>
        <td>
            <%= sprintf "%s", total %>
        </td>
    </tr>
    <tr><td><br/></td></tr>
    <tr class='highlight'>
        <td class="statsTableTitle">
            Indicated Decisions
        </td>
        <% total = 0 %>
        <% @months.each do |month| -%>
        <% start_date = Month.find_start_date(month.id) %>
        <% end_date = Month.find_end_date(month.id) %>
        <% result = Prc.count_by_date_per_ministry(start_date,end_date,@stats_ministry_id) %>
        <% total += result %>
        <td>
            <%= sprintf "%s", result %>
        </td>
        <% end %>
        <td>
            <%= sprintf "%s", total %>
        </td>
    </tr>
</table>
