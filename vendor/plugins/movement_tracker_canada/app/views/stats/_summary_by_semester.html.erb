<div class="statsSubFormContainer">
  <div class="statsSubFormBox">
    <% form_for :report, :html => { :name => 'reportForm' } do |form| %>
      <br/>
      <p class="statsFormField">
        <%= form.label :semester, "Semester:" %>
        <%= form.collection_select :semester, @semesters, :id, :description, :selected => @semester_id.to_i %>
        <%= observe_field 'report_semester', :url => {:action => "select_report"},
                                             :with => "getWithStringForReportForm() + '&semester=' + value",
                                             :before => "beginLoadingStatsTab()",
                                             :complete => "completeLoadingStatsTab()" %>
      </p>
    <% end %>
  </div>
</div>


<p><span class="statsTitle"><%= @report_description %></span></p>
<table class="t1">
    <tr>
        <td class="t2">
        </td>
        <% @months.each do |month| -%>
        <td>
            <span class="title1"><%= sprintf "%s", month.description %></span>
        </td>
        <% end %>
        <td>
            <span class="title1">Total</span>
        </td>
    </tr>
    <tr class="<%= cycle('highlight', 'nohighlight') %>">
        <td>
            Spiritual Conversations by Staff
        </td>
        <% total = 0 %>
        <% @months.each do |month| -%>
        <% result = Week.find_ministry_stats_month(month.id,@ministry_id,sp_conv) %>
        <% total += result %>
        <td>
            <center>
                <%= sprintf "%s", result %>
            </center>
        </td>
        <% end %>
        <td>
            <center>
                <%= sprintf "%s", total %>
            </center>
        </td>
    </tr>
    <tr class="<%= cycle('highlight', 'nohighlight') %>">
        <td>
            Spiritual Conversations by Students
        </td>
        <% total = 0 %>
        <% @months.each do |month| -%>
        <% result = Week.find_ministry_stats_month(month.id,@ministry_id,sp_conv_std) %>
        <% total += result %>
        <td>
            <center>
                <%= sprintf "%s", result %>
            </center>
        </td>
        <% end %>
        <td>
            <center>
                <%= sprintf "%s", total %>
            </center>
        </td>
    </tr>
    <tr class="<%= cycle('highlight', 'nohighlight') %>">
        <td>
            Gospel Presentations by Staff
        </td>
        <% total = 0 %>
        <% @months.each do |month| -%>
        <% result = Week.find_ministry_stats_month(month.id,@ministry_id,gos_pres) %>
        <% total += result %>
        <td>
            <center>
                <%= sprintf "%s", result %>
            </center>
        </td>
        <% end %>
        <td>
            <center>
                <%= sprintf "%s", total %>
            </center>
        </td>
    </tr>
    <tr class="<%= cycle('highlight', 'nohighlight') %>">
        <td>
            Gospel Presentations by Students
        </td>
        <% total = 0 %>
        <% @months.each do |month| -%>
        <% result = Week.find_ministry_stats_month(month.id,@ministry_id,gos_pres_std) %>
        <% total += result %>
        <td>
            <center>
                <%= sprintf "%s", result %>
            </center>
        </td>
        <% end %>
        <td>
            <center>
                <%= sprintf "%s", total %>
            </center>
        </td>
    </tr>
    <tr class="<%= cycle('highlight', 'nohighlight') %>">
        <td>
            Holy Spirit Presentations by Staff
        </td>
        <% total = 0 %>
        <% @months.each do |month| -%>
        <% result = Week.find_ministry_stats_month(month.id,@ministry_id,hs_pres) %>
        <% total += result %>
        <td>
            <center>
                <%= sprintf "%s", result %>
            </center>
        </td>
        <% end %>
        <td>
            <center>
                <%= sprintf "%s", total %>
            </center>
        </td>
    </tr>
    <tr class="<%= cycle('highlight', 'nohighlight') %>">
        <td>
            <br/>
            Indicated Decisions
        </td>
        <% total = 0 %>
        <% @months.each do |month| -%>
        <% start_date = Month.find_start_date(month.id) %>
        <% end_date = Month.find_end_date(month.id) %>
        <% result = Prc.count_by_date_per_ministry(start_date,end_date,@ministry_id) %>
        <% total += result %>
        <td>
            <br/>
            <center>
                <%= sprintf "%s", result %>
            </center>
        </td>
        <% end %>
        <td>
            <br/>
            <center>
                <%= sprintf "%s", total %>
            </center>
        </td>
    </tr>
</table>
