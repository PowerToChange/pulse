
<% if @staff.present? %>

  <br/>
  <table id="statsTotalsTable">
      <tr class="<%= cycle('highlight', 'nohighlight') %>">
          <td class="t5">
              Spritual Conversations
          </td>
          <td class="t5">
              <% sp_conv_total = Week.find_stats_semester_campus(@semester_id, @campus_id, sp_conv) %>
              <%= sp_conv_total %>
          </td>
      </tr>
      <tr class="<%= cycle('highlight', 'nohighlight') %>">
          <td class="t5">
              Spritual Conversations by Disciples
          </td>
          <td class="t5">
              <% sp_conv_std_total = Week.find_stats_semester_campus(@semester_id, @campus_id, sp_conv_std) %>
              <%= sp_conv_std_total %>
          </td>
      </tr>
      <tr class="<%= cycle('highlight', 'nohighlight') %>">
          <td class="t5">
              Gospel Presentations
          </td>
          <td class="t5">
              <% gos_pres_total = Week.find_stats_semester_campus(@semester_id, @campus_id, gos_pres) %>
              <%= gos_pres_total %>
          </td>
      </tr>
      <tr class="<%= cycle('highlight', 'nohighlight') %>">
          <td class="t5">
              Gospel Presentations by Disciples
          </td>
          <td class="t5">
              <% gos_pres_std_total = Week.find_stats_semester_campus(@semester_id, @campus_id, gos_pres_std) %>
              <%= gos_pres_std_total %>
          </td>
      </tr>
      <tr class="<%= cycle('highlight', 'nohighlight') %>">
          <td class="t5">
              Holy Spirit Presentations
          </td class="t5">
          <td class="t5">
              <% hs_pres_total = Week.find_stats_semester_campus(@semester_id, @campus_id, hs_pres) %>
              <%= hs_pres_total %>
          </td>
      </tr>
      <tr class="<%= cycle('highlight', 'nohighlight') %>">
          <td class="t5">
              Indicated Decisions
          </td>
          <td class="t5">
              <% indicated_decisions_total = Prc.count_by_semester_and_campus(@semester_id, @campus_id) %>
              <%= indicated_decisions_total %>
          </td>
      </tr>
  </table>

  <br/>
  <br/>

  <% @staff.each do |s| %>
    <% if s['staff_id'] > -1 %>
      <% person_id = CimHrdbStaff.find_person_id(s['staff_id']) %>
    <% end %>
    <% employee = Person.find_person(person_id) %>
    <% if !employee.nil? %>
      <div class="tableTitle"><%= "#{employee.first_name.capitalize} #{employee.last_name.capitalize}" %></div>
      <table class="t1">
          <tr>
              <td class="t2">
              </td>
              <% @months.each do |month| %>
                <% number_weeks = Week.find_weeks_in_month(month.id).length %>
                <% if number_weeks == 5 %>
                  <td colspan="5">
                <% else %>
                  <td colspan="4">
                <% end %>
                <center>
                <%= month.description.split(" ")[0] %>
                </center>
                </td>
              <% end %>
          </tr>
          <tr>
              <td class="t2">
              </td>
              <% @weeks.each do |week| %>
                <td>
                <center>
                <%= week.end_date.day %>
                </center>
                </td>
              <% end %>
              <td>
                  <center>
                      Total
                  </center>
              </td>
          </tr>
          <tr class="<%= cycle('highlight', 'nohighlight') %>">
              <td class="t5">
                  <span class="bold">Spiritual Conversations</span>
              </td>
              <% total = 0 %>
              <% @weeks.each do |week| %>
                <td class="t5">
                  <center>
                    <%= stat = Week.find_stats_staff(week.id,s['staff_id'],sp_conv,@campus_id) %>
                    <% total += stat %>
                  </center>
                </td>
              <% end %>
              <td class="t5">
                  <center>
                      <%= total %>
                  </center>
              </td>
          </tr>
          <tr class="<%= cycle('highlight', 'nohighlight') %>">
              <td class="t5">
                  <span class="bold">Spiritual Conversations by Disciples</span>
              </td>
              <% total = 0 %>
              <% @weeks.each do |week| %>
              <td class="t5">
                  <center>
                      <%= stat = Week.find_stats_staff(week.id,s['staff_id'],sp_conv_std,@campus_id) %>
                      <% total += stat %>
                  </center>
              </td>
              <% end %>
              <td class="t5">
                  <center>
                      <%= total %>
                  </center>
              </td>
          </tr>
          <tr class="<%= cycle('highlight', 'nohighlight') %>">
              <td class="t5">
                  <span class="bold">Gospel Presentations</span>
              </td>
              <% total = 0 %>
              <% @weeks.each do |week| %>
              <td class="t5">
                  <center>
                      <%= stat = Week.find_stats_staff(week.id,s['staff_id'],gos_pres,@campus_id) %>
                      <% total += stat %>
                  </center>
              </td>
              <% end %>
              <td class="t5">
                  <center>
                      <%= total %>
                  </center>
              </td>
          </tr>
          <tr class="<%= cycle('highlight', 'nohighlight') %>">
              <td class="t5">
                  <span class="bold">Gospel Presentations by Disciples</span>
              </td>
              <% total = 0 %>
              <% @weeks.each do |week| %>
              <td class="t5">
                  <center>
                      <%= stat = Week.find_stats_staff(week.id,s['staff_id'],gos_pres_std,@campus_id) %>
                      <% total += stat %>
                  </center>
              </td>
              <% end %>
              <td class="t5">
                  <center>
                      <%= total %>
                  </center>
              </td>
          </tr>
          <tr class="<%= cycle('highlight', 'nohighlight') %>">
              <td class="t5">
                  <span class="bold">Holy Spirit Presentations</span>
              </td>
              <% total = 0 %>
              <% @weeks.each do |week| %>
              <td class="t5">
                  <center>
                      <%= stat = Week.find_stats_staff(week.id,s['staff_id'],hs_pres,@campus_id) %>
                      <% total += stat %>
                  </center>
              </td>
              <% end %>
              <td class="t5">
                  <center>
                      <%= total %>
                  </center>
              </td>
          </tr>
          <tr class="<%= cycle('highlight', 'nohighlight') %>">
              <td class="t5">
                  <span class="bold">Submitted</span>
              </td>
              <% total = 0 %>
              <% @weeks.each do |week| %>
              <td class="t5">
                  <center>
                      <% if !WeeklyReport.check_submitted(week.id,s['staff_id'],@campus_id).nil? %>
                      x<% total += 1 %>
                      <% else %>
                      -<% end %>
                  </center>
              </td>
              <% end %>
              <td class="t5">
                  <center>
                      <%= total %>
                  </center>
              </td>
          </tr>
      </table>
      <br/>
    <% end %>
  <% end %>



<% else %>

  <p>Sorry, no stats for this campus and semester were found.</p>
    
<% end %>
