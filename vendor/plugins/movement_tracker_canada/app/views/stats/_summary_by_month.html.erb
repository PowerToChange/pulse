
<p><span class="statsTitle"><%= @report_description %></span></p>
<table class="statsTable">
    <tr>
        <td>
        </td>
        <% i = 1 %>
        <% @weeks.each do |week| -%>
          <td class="statsTableTitle">
              <%= sprintf "Week %s", i %>
          </td>
          <% i+= 1 %>
        <% end %>
        <td class="statsTableTitle">
            Total
        </td>
    </tr>
    <tr class="<%= cycle('highlight', 'nohighlight') %>">
        <td class="statsTableTitle">
            Spiritual Conversations by Staff
        </td>
        <% total = 0 %>
        <% @weeks.each do |week| -%>
        <% result = Week.find_ministry_stats_week(week.id,@stats_ministry_id,sp_conv) %>
        <% total += result %>
        <td>
            <%= sprintf "%s", result %>
        </td>
        <% end %>
        <td>
            <%= sprintf "%s", total %>
        </td>
    </tr>
    <tr class="<%= cycle('highlight', 'nohighlight') %>">
        <td class="statsTableTitle">
            Spiritual Conversations by Students
        </td>
        <% total = 0 %>
        <% @weeks.each do |week| -%>
        <% result = Week.find_ministry_stats_week(week.id,@stats_ministry_id,sp_conv_std) %>
        <% total += result %>
        <td>
            <%= sprintf "%s", result %>
        </td>
        <% end %>
        <td>
            <%= sprintf "%s", total %>
        </td>
    </tr>
    <tr class="<%= cycle('highlight', 'nohighlight') %>">
        <td class="statsTableTitle">
            Gospel Presentations by Staff
        </td>
        <% total = 0 %>
        <% @weeks.each do |week| -%>
        <% result = Week.find_ministry_stats_week(week.id,@stats_ministry_id,gos_pres) %>
        <% total += result %>
        <td>
            <%= sprintf "%s", result %>
        </td>
        <% end %>
        <td>
            <%= sprintf "%s", total %>
        </td>
    </tr>
    <tr class="<%= cycle('highlight', 'nohighlight') %>">
        <td class="statsTableTitle">
            Gospel Presentations by Students
        </td>
        <% total = 0 %>
        <% @weeks.each do |week| -%>
        <% result = Week.find_ministry_stats_week(week.id,@stats_ministry_id,gos_pres_std) %>
        <% total += result %>
        <td>
            <%= sprintf "%s", result %>
        </td>
        <% end %>
        <td>
            <%= sprintf "%s", total %>
        </td>
    </tr>
    <tr class="<%= cycle('highlight', 'nohighlight') %>">
        <td class="statsTableTitle">
            Holy Spirit Presentations by Staff
        </td>
        <% total = 0 %>
        <% @weeks.each do |week| -%>
        <% result = Week.find_ministry_stats_week(week.id,@stats_ministry_id,hs_pres) %>
        <% total += result %>
        <td>
            <%= sprintf "%s", result %>
        </td>
        <% end %>
        <td>
            <%= sprintf "%s", total %>
        </td>
    </tr>
    <tr><td><br/></td></tr>
    <tr class="highlight">
        <td class="statsTableTitle">
            Indicated Decisions
        </td>
        <% total = 0 %>
        <% @weeks.each do |week| -%>
        <% start_date = Week.find_start_date(week.id) %>
        <% end_date = Week.find_end_date(week.id) %>
        <% result = Prc.count_by_date_per_ministry(start_date,end_date,@stats_ministry_id) %>
        <% total += result %>
        <td>
            <%= sprintf "%s", result %>
        </td>
        <% end %>
        <td>
            <%= sprintf "%s", total %>
        </td>
    </tr>
</table>
