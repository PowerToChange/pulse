<% @site_title = t('title.contacts') -%>

<% content_for :javascripts do %>
  <%= javascript_include_tag "widgets/tooltip.js" %>
  <%= javascript_include_tag "contacts.js" %>
<% end %>


<div id="timetable_link">
</div>

<div class="sectionHeader">
  <h1 id="reportTitle">Contacts for Followup</h1>

  <br>
  <p>This tool is designed to facilitate personal follow-up of contacts by phone. If you require campus-wide data sets of information for your campus, please contact <%= mail_to "colby.warkentin@p2c.com" %>.</p>
  <p>Note: There is currently a lag of about 12 hours between when a contact is input and when they will be listed for follow-up.</p>
  <p><%= link_to 'Survey Data Input', 'https://connect.powertochange.org/node/2' %> | <%= link_to 'Online Cravings Survey', 'http://cravings.powertochange.com/' %> | <%= link_to 'Training', 'http://powertochange.com/students/resources/september-launch-vision/' %></p>

<%= render :partial => 'search_box' %>


<%
unless @contacts.nil? 
%>

<div class="yoursearch">
	<p>
		<%= @search_description %>
	</p>
</div>


<div id="assign_people">
	<% form_remote_tag(:url => '/contacts/multiple_assign', :name => 'contacts_form', :id => 'contacts_form', :before => "$('#assign_people form input[type=submit]').disable(); $('#spinnerAssignMultiple').show();") do %>
		<%= hidden_field_tag 'contacts_to_assign' %>
		Assign selected contacts to <%= select_tag "multiple_assign_to", options_for_select(people_available) %> <%= submit_tag 'Assign', :class => "action-button" %>
	<%- end -%>
	<%= spinner('AssignMultiple') %>
</div>

<p><%= will_paginate @contacts, :class => "searchResultsPagination" %></p>

<div id="people">
	<table cellpadding="0" cellspacing="0" class="directorytable">
		<thead class="center">
		  <tr>
			<th><%= check_box_tag 'select_all', 0, false %></th>
			<th>First Name</th>
			<th>Last Name</th>
			<th>Sex</th>
			<th>Cellphone</th>
			<th>Priority</th>
			<th>Assigned to</th>
			<th>Status</th>
			<th>Result</th>
			<th>&nbsp;</th>
		</tr>
		</thead>
		<tbody>
		<%- @contacts.each_with_index do |contact, i|  -%>
			<tr class="<%= i.even? ? 'highlight' : 'nohighlight' %>">
				<td width="10px">
					<%= check_box_tag 'contact[]', contact[:id], false %> 
				</td>
				<td style="white-space: nowrap;" class="person_row" person_link="/contacts/edit/<%= contact[:id] %>"><%= contact[:first_name] %></td>
				<td style="white-space: nowrap;" class="person_row" person_link="/contacts/edit/<%= contact[:id] %>"><%= contact[:last_name] %></td>
				<td style="white-space: nowrap;" class="person_row" person_link="/contacts/edit/<%= contact[:id] %>"><%= contact_gender(contact) %></td>
				<td style="white-space: nowrap;" class="person_row" person_link="/contacts/edit/<%= contact[:id] %>"><%= contact[:cellphone] %></td>
				<td style="white-space: nowrap;" class="person_row" person_link="/contacts/edit/<%= contact[:id] %>"><%= contact[:priority] %></td>
				<td style="white-space: nowrap;" class="person_row" person_link="/contacts/edit/<%= contact[:id] %>"><%= assigned_to(contact) %></td>
				<td style="white-space: nowrap;" class="person_row" person_link="/contacts/edit/<%= contact[:id] %>"><%= contact_status(contact) %></td>
				<td style="white-space: nowrap;" class="person_row" person_link="/contacts/edit/<%= contact[:id] %>"><%= contact_result(contact) %></td>
				<td class="alignright">
					<span class="butProfile"><%= link_to 'Edit', "/contacts/edit/#{contact[:id]}", :title => "View the contact's informations" %></span>
				</td>
			</tr>
		<%- end -%>
			
		</tbody>
	</table>

	<p><%= will_paginate @contacts, :class => "searchResultsPagination" %></p>
  
</div>
<%- end -%>
<br />
<br />

