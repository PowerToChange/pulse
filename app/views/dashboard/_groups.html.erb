<div class="modulecontent">
  <ul class="groupicon">
    <% @person.all_groups.current_and_next_semester.group_by(&:semester).each do |semester, groups| %>
      <%- for group in groups %>
      <div><%= semester.desc %></div>
      <li>
        <%- if authorized?(:accept_request, :group_involvements) || 
              authorized?(:decline_requests, :group_involvements) %>
          <%= link_to(group.name, group) %>
          <ul class="requesticon">
            <%= render :partial => 'groups/member_request', :collection => group.requests, 
              :locals => { :source => 'dashboard' } %>
          </ul>
        <%- elsif group.is_interested(@me) -%>
          <%= link_to(group.name, group) %>, Interested
        <%- elsif group.has_requested(@me) -%>
          <%= link_to(group.name, group) %>, Awaiting join request decision
        <%- else -%>
          <%= link_to(group.name, group) %>
        <%- end -%>
      </li>
      <%- end %>
    <%- end -%>
  </ul>
  <%= link_to 'Join a Group', :controller => "groups", :action => "join"%> 
  &nbsp
  <%- tooltip do -%> 
    Click here to go to the page where you can request joining a group. 
  <%- end -%>
</div>
